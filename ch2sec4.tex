\documentclass{article}
\usepackage{amsmath, amssymb, amsthm, graphicx}
\usepackage[export]{adjustbox}

\title{Chapter 2 Section 4}
\author{Andrew Taylor}
\date{April 16 2022}
\newtheorem{theorem}{Theorem}
\newtheorem{problem}{Problem}
\newtheorem*{solution}{Solution}

\begin{document}
\maketitle

\begin{theorem}
An $n \times n$ matrix A is invertible if and only if

\begin{align*}
rref(A) = I_{n}
\end{align*}

or, equivalently, if

\begin{align*}
rank(A) = n
\end{align*}

\end{theorem}

\begin{theorem}
To find the inverse of an $n \times n$ matrix A, form the $n \times (2n)$ matrix $\begin{bmatrix} A \ \vert \ I_{n} \end{bmatrix}$ and compute $rref [A \ \vert \ I_{n}]$. 

\begin{itemize}
\item If $rref [A \ \vert \ I_{n}]$ is of the form $\begin{bmatrix} I_{n} \ \vert \ B \end{bmatrix}$ then A is invertible and $A^{-1} = B$.
\item If $rref [A \ \vert \ I_{n}]$ is of another form (i.e., its left half fails to be $I_{n}$) then A is not invertible. 
\end{itemize}
\end{theorem}

\begin{theorem}
For an invertible $n \times n$ matrix A, 

\begin{align*}
A^{-1} A = I_{n} \quad \textrm{and} \quad AA^{-1} = I_{n}
\end{align*}
\end{theorem}

\begin{theorem}
If A and B are invertible $n \times n$ matrices, then BA is invertible as well, and 

\begin{align*}
(BA)^{-1} = A^{-1} B^{-1}
\end{align*}
\end{theorem}

\begin{theorem}
Let A and B be two $n \times n$ matrices such that $BA = I_{n}$. Then

\begin{itemize}
\item A and B are both invertible
\item $A^{-1} = B$ and $B^{-1} = A$
\item $AB = I_{n}$
\end{itemize}
\end{theorem}

\begin{problem}
Is the matrix

\begin{align*}
A = \begin{bmatrix}
1 & 1 & 1 \\
2 & 3 & 2 \\
3 & 8 & 2
\end{bmatrix}
\end{align*}

invertible? If so, find the inverse of $A$.
\end{problem}

\begin{solution}
\begin{align*}
& \begin{bmatrix}
1 & 1 & 1 \\
2 & 3 & 2 \\
3 & 8 & 2
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 1 \\
0 & 1 & 0 \\
0 & 5 & -1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 1 \\
0 & 1 & 0 \\
0 & 0 & -1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 1 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
\end{align*}

We see that 

\begin{align*}
rref(A) = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
\end{align*}

Thus A is invertible. \\

Note that $rref(A)$ is an acronym that refers to the reduced row echelon form of matrix A. The computation $rref(A)$ tells us whether A is invertible. \\

To invert the matrix, let's calculate $rref \begin{bmatrix} A \ \vert \ I_{n} \end{bmatrix}$. \\

\begin{align*}
& \begin{bmatrix}
1 & 1 & 1 & \vert & 1 & 0 & 0 \\
2 & 3 & 2 & \vert & 0 & 1 & 0 \\
3 & 8 & 2 & \vert & 0 & 0 & 1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 1 & \vert & 1 & 0 & 0 \\
0 & 1 & 0 & \vert & -2 & 1 & 0 \\
0 & 5 & -1 & \vert & -3 & 0 & 1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 1 & \vert & 1 & 0 & 0 \\
0 & 1 & 0 & \vert & -2 & 1 & 0 \\
0 & 0 & -1 & \vert & 7 & -5 & 1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 1 & \vert & 1 & 0 & 0 \\
0 & 1 & 0 & \vert & -2 & 1 & 0 \\
0 & 0 & 1 & \vert & -7 & 5 & -1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 1 & 0 & \vert & 8 & -5 & 1 \\
0 & 1 & 0 & \vert & -2 & 1 & 0 \\
0 & 0 & 1 & \vert & -7 & 5 & -1
\end{bmatrix} \\
& \begin{bmatrix}
1 & 0 & 0 & \vert & 10 & -6 & 1 \\
0 & 1 & 0 & \vert & -2 & 1 & 0 \\
0 & 0 & 1 & \vert & -7 & 5 & -1
\end{bmatrix} \\
\end{align*}

Thus 

\begin{align*}
rref \begin{bmatrix} A \ \vert \ I_{n} \end{bmatrix} = \begin{bmatrix}
1 & 0 & 0 & \vert & 10 & -6 & 1 \\
0 & 1 & 0 & \vert & -2 & 1 & 0 \\
0 & 0 & 1 & \vert & -7 & 5 & -1
\end{bmatrix}
\end{align*}

and 

\begin{align*}
A^{-1} = \begin{bmatrix}
10 & -6 & 1 \\
-2 & 1 & 0 \\
-7 & 5 & -1
\end{bmatrix}
\end{align*}

\end{solution}

\begin{problem}
Suppose A, B, and C are three $n \times n$ matrices such that $ABC = I_{n}$. Show that B is invertible, and express $B^{-1}$ in terms of A and C.
\end{problem}

\begin{solution}
By the associative property of matrices

\begin{align*}
ABC &= I_{n} \\
(AB)C &= I_{n} \\
A(BC) &= I_{n} 
\end{align*}

Thus matrices A and C are invertible. 

\begin{align*}
ABC &= I_{n} \\
A^{-1}ABC &= A^{-1} I_{n} \\
BC &= A^{-1} \\
%BCC^{-1} &= A^{-1} I_{n} C^{-1} \\
%B &= A^{-1} C^{-1} \\
BCA &= A^{-1} A \\
B(CA) &= I_{n}
\end{align*}

Thus matrix B is invertible and $B^{-1} = CA$.

\end{solution}

\begin{problem}
For an arbitrary $2 \times 2$ matrix $A = \begin{bmatrix} a & b \\ c & d \end{bmatrix}$ compute the product $\begin{bmatrix}d & -b \\ -c & a \end{bmatrix} \begin{bmatrix}a & b \\ c & d \end{bmatrix}$. When is A invertible? If so, what is $A^{-1}$?
\end{problem}

\begin{solution}
\begin{align*}
& \begin{bmatrix}d & -b \\ -c & a \end{bmatrix}
\begin{bmatrix} a & b \\ c & d \end{bmatrix} \\
&= \begin{bmatrix} ad - bc & 0 \\ 0 & ad - bc \end{bmatrix}
\end{align*}

When $ad - bc$ is nonzero, we can form the product

\begin{align*}
& \displaystyle \frac{1}{ad-bc} \begin{bmatrix}d & -b \\ -c & a \end{bmatrix}
\begin{bmatrix} a & b \\ c & d \end{bmatrix} \\
&= \displaystyle \frac{1}{ad-bc} \begin{bmatrix} ad - bc & 0 \\ 0 & ad - bc \end{bmatrix} \\
&= \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}
\end{align*}

Thus A is invertible when the determinant $ad - bc \neq 0$, and 

\begin{align*}
A^{-1} = \displaystyle \frac{1}{ad-bc} \begin{bmatrix}d & -b \\ -c & a \end{bmatrix}
\end{align*}

\end{solution}

\begin{problem}
Is the matrix $A = \begin{bmatrix}1 & 3 \\ 2 & 1\end{bmatrix}$ invertible? If so, find the inverse. Interpret det A geometrically.
\end{problem}

\begin{solution}
\begin{align*}
\det A = 1*1 - 2*3 = -5
\end{align*}

Since $\det A = -5$ is nonzero, the matrix is invertible. 

\begin{align*}
A^{-1} &= \displaystyle \frac{1}{-5} \begin{bmatrix}1 & -3 \\ -2 & 1\end{bmatrix} \\ \\
&= \begin{bmatrix}-\dfrac{1}{5} & \dfrac{3}{5} \\ \\ \dfrac{2}{5} & -\dfrac{1}{5}\end{bmatrix}
\end{align*}

The quantity $\lvert \det A \rvert$ is the area of the shaded parallelogram constructed from the vectors $\vec{v} = \begin{bmatrix} 1 \\ 2 \end{bmatrix}$ and $\vec{w} = \begin{bmatrix}3 \\ 1 \end{bmatrix}$. The determinant is negative since the angle from $\vec{v}$ to $\vec{w}$ is negative.

\end{solution}

\begin{problem}
For which values of the constant k is the matrix $A = \begin{bmatrix} 1-k & 2 \\ 4 & 3-k \end{bmatrix}$ invertible?
\end{problem}

\begin{solution}
The matrix A is invertible when $\det A$ is nonzero.

\begin{align*}
\det A &= (1-k)(3-k) - 2*4 \\
&= 3 - 4k+ k^2 - 8 \\
&= k^2 - 4k - 5 \\
&= (k - 5)(k + 1)
\end{align*} 

The matrix A is invertible when $k \neq 5$ and when $k \neq -1$. \\

In other words, A is invertible for all values of k except $k = 5$ and $k = -1$.
\end{solution}

\begin{problem}
Consider a matrix A that represents the reflection about a line L in the plane. Use the determinant to verify that A is invertible. Find $A^{-1}$. Explain your answer conceptually, and interpret the determinant geometrically.
\end{problem}

\begin{solution}
Since A is a reflection matrix, we know that A is of the form

\begin{align*}
\begin{bmatrix}
a & b \\ b & -a
\end{bmatrix}
\end{align*}

We can calculate the determinant of A.

\begin{align*}
\det A &= -a^2 - b^2 \\
&= -(a^2 + b^2)
\end{align*}

Since the determinant is only zero when $a = b = 0$, we can say that $A$ is invertible for all values except $a = b = 0$.

\begin{align*}
A^{-1} &= \displaystyle -\frac{1}{a^2+b^2} \begin{bmatrix}-a & -b \\ -b & a \end{bmatrix} \\
&= \displaystyle \frac{1}{a^2+b^2} \begin{bmatrix}a & b \\ b & -a \end{bmatrix}
\end{align*}

Strictly speaking, a reflection matrix is of the form 

\begin{align*}
\begin{bmatrix}a & b \\ b & -a\end{bmatrix}
\end{align*}

where $a^2 + b^2 = 1$. So we can substitute $a^2+b^2 = 1$ into our inverse. We can also assume that the determinant is nonzero since $a^2+b^2 = 1$. Thus every reflection matrix is invertible.

\begin{align*}
A^{-1} &= \displaystyle \frac{1}{a^2+b^2} \begin{bmatrix}a & b \\ b & -a \end{bmatrix} \\
&= \displaystyle \frac{1}{1} \begin{bmatrix}a & b \\ b & -a \end{bmatrix} \\
&= \begin{bmatrix}a & b \\ b & -a \end{bmatrix} \\
&= A
\end{align*}

We find that every reflection matrix A is invertible, and that $A^{-1} = A$. \\

The determinant of A is actually the area of a unit square. Let $\vec{v} = \begin{bmatrix} a \\ b \end{bmatrix}$ and $\vec{w} = \begin{bmatrix} b \\ -a \end{bmatrix}$. The vectors $\vec{v}$ and $\vec{w}$ form a parallelogram, and this parallelogram is a unit square. \\

We can write the determinant as

\begin{align*}
\det A &= \lVert \vec{v} \rVert \sin \theta \lVert \vec{w} \rVert \\
&= \lVert \sqrt{a^2+b^2} \rVert \sin \left(\displaystyle -\frac{\pi}{2}\right) \lVert \sqrt{b^2 + (-a)^2} \rVert \\
&= -1
\end{align*}

where $\theta$ is the angle between vectors $\vec{v}$ and $\vec{w}$. \\

In summary, every reflection matrix A is invertible, since $\det A = -1$ for all reflection matrices. The inverse of a reflection matrix A is $A^{-1} = A$. The determinant of a reflection matrix is the area of a unit square formed by the two column vectors of the reflection matrix. This area is negative because the angle between the vectors $\left(\displaystyle -\frac{\pi}{2}\right)$ is negative.

\end{solution}

\begin{problem}
Let A be a block matrix

\begin{align*}
A = \begin{bmatrix} A_{11} & A_{12} \\ 0 & A_{22} \end{bmatrix}
\end{align*}

where $A_{11}$ is an $n \times n$ matrix, $A_{22}$ is an $m \times m$ matrix, and $A_{12}$ is an $n \times m$ matrix. \\

\begin{itemize}
\item For which choices of $A_{11}$, $A_{12}$, and $A_{22}$ is A invertible?
\item If A is invertible, what is $A^{-1}$ (in terms of $A_{11}$, $A_{12}$, $A_{22}$)?
\end{itemize}

\end{problem}

\begin{solution}
We are looking for a matrix B such that

\begin{align*}
BA = I_{n + m} = \begin{bmatrix} I_{n} & 0 \\ 0 & I_{m} \end{bmatrix}
\end{align*}

Let us partition B in the same way as A.

\begin{align*}
B = \begin{bmatrix} B_{11} & B_{12} \\ B_{21} & B_{22} \end{bmatrix}
\end{align*}

where $B_{11}$ is $n \times n$, $B_{12}$ is $m \times m$, and so on. We know that 

\begin{align*}
\begin{bmatrix} B_{11} & B_{12} \\ B_{21} & B_{22} \end{bmatrix} \begin{bmatrix} A_{11} & A_{12} \\ 0 & A_{22} \end{bmatrix} = \begin{bmatrix} I_{n} & 0 \\ 0 & I_{m} \end{bmatrix}
\end{align*}

Thus

\begin{align*}
B_{11} A_{11} &= I_{n} \\
B_{11} A_{12} + B_{12} A_{22} &= 0 \\
B_{21} A_{11} + B_{22} 0 &= 0 \\
B_{21} A_{12} + B_{22} A_{22} &= I_{m}
\end{align*}

This gives us

\begin{align*}
B_{11} &= A_{11}^{-1} \\
B_{12} & = - A_{11}^{-1} A_{12} A_{22}^{-1} \\
B_{21} &= 0 \\
B_{22} &= A_{22}^{-1}
\end{align*}

We find that A is invertible when $A_{11}$ and $A_{22}$ are invertible. \\

When A is invertible, the inverse of A is given by

\begin{align*}
B = A^{-1} = \begin{bmatrix}
A_{11}^{-1} & -A_{11}^{-1} A_{12} A_{22}^{-1} \\ \\
0 & A_{22}^{-1}
\end{bmatrix}
\end{align*}

\end{solution}

\begin{problem}
Verify this result for the following example:

\begin{align*}
& \left(
\begin{array}{@{}cc|ccc@{}}
1 & 1 & 1 & 2 & 3 \\
1 & 2 & 4 & 5 & 6 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{array}
\right)^{-1} =
\left(
\begin{array}{@{}cc|ccc@{}}
2 & -1 & 2 & 1 & 0 \\
-1 & 1 & -3 & -3 & -3 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{array}
\right) 
\end{align*}
\end{problem}

\begin{solution}
\begin{align*}
& \left(
\begin{array}{@{}cc|ccc@{}}
1 & 1 & 1 & 2 & 3 \\
1 & 2 & 4 & 5 & 6 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{array}
\right)
\left(
\begin{array}{@{}cc|ccc@{}}
2 & -1 & 2 & 1 & 0 \\
-1 & 1 & -3 & -3 & -3 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{array}
\right) \\
&= \left( \begin{array}{@{}c|c@{}}
\begin{bmatrix}1 & 1 \\ 1 & 2 \end{bmatrix} \begin{bmatrix}2 & -1 \\ -1 & 1 \end{bmatrix} + \begin{bmatrix}1 & 2 & 3 \\ 4 & 5 & 6 \end{bmatrix} \begin{bmatrix}0 & 0 \\ 0 & 0 \\ 0 & 0 \end{bmatrix}
& \begin{bmatrix}1 & 1 \\ 1 & 2 \end{bmatrix} \begin{bmatrix} 2 &1 & 0 \\ -3 & -3 & -3 \end{bmatrix} + \begin{bmatrix}1 & 2 & 3 \\ 4 & 5 & 6 \end{bmatrix} \begin{bmatrix}1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}  \\ \hline
\begin{bmatrix}0 & 0 \\ 0 & 0 \\ 0 & 0 \end{bmatrix} & \begin{bmatrix}1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}
\end{array} \right) \\
&= \left( \begin{array}{@{}c|c@{}}
\begin{bmatrix}1 & 0 \\ 0 & 1 \end{bmatrix} + \begin{bmatrix}0 & 0 \\ 0 & 0 \end{bmatrix} & \begin{bmatrix} -1 &-2 & -3 \\ -4 & -5 & -6 \end{bmatrix} + \begin{bmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \end{bmatrix} \\ \hline
\begin{bmatrix}0 & 0 \\ 0 & 0 \\ 0 & 0 \end{bmatrix} & \begin{bmatrix}1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}
\end{array} \right) \\
&= \left( \begin{array}{@{}c|c@{}}
\begin{bmatrix}1 & 0 \\ 0 & 1 \end{bmatrix}  & \begin{bmatrix} 0 & 0 & 0 \\ 0 & 0 & 0 \end{bmatrix}  \\ \hline
\begin{bmatrix}0 & 0 \\ 0 & 0 \\ 0 & 0 \end{bmatrix} & \begin{bmatrix}1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}
\end{array} \right) \\
&= \left( \begin{array}{@{}cc|ccc@{}}
1 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1 
\end{array} \right)
\end{align*}

Since the product of the two matrices is $I_{5}$, the identity matrix, we know that

\begin{align*}
\left(
\begin{array}{@{}cc|ccc@{}}
1 & 1 & 1 & 2 & 3 \\
1 & 2 & 4 & 5 & 6 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{array}
\right)^{-1} =
\left(
\begin{array}{@{}cc|ccc@{}}
2 & -1 & 2 & 1 & 0 \\
-1 & 1 & -3 & -3 & -3 \\ \hline
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{array}
\right) 
\end{align*}
\end{solution}

In the next fifteen problems, decide whether the matrices are invertible. If they are, find the inverse.

\begin{problem}
\begin{align*}
\begin{bmatrix}
2 & 3 \\ 5 & 8
\end{bmatrix}
\end{align*}
\end{problem}

\begin{solution}
The determinant is $2 * 8 - 5 * 3 = 16 - 15 = 1$. Since the determinant is nonzero, the matrix is invertible. \\

The inverse is given by swapping the entries $(1, 1)$ and $(2, 2)$, negating the entries $(1, 2)$ and $(2, 1)$, and dividing by the determinant.

\begin{align*}
\begin{bmatrix}
2 & 3 \\ 5 & 8
\end{bmatrix}^{-1} 
&= \displaystyle \frac{1}{1} \begin{bmatrix}
8 & -3 \\ -5 & 2
\end{bmatrix} \\
&= \begin{bmatrix}
8 & -3 \\ -5 & 2
\end{bmatrix}
\end{align*}
\end{solution}

\begin{theorem}
If a matrix $A = \begin{bmatrix} a & b \\ c & d \end{bmatrix}$ is invertible, then the inverse of $A$ is

\begin{align*}
A^{-1} = \displaystyle \frac{1}{\det A} \begin{bmatrix} d & -b \\ -c & a \end{bmatrix}
\end{align*}
\end{theorem}

We will use this theorem in the following problems, as we did in the previous problem.

\begin{problem}
\begin{align*}
\begin{bmatrix}
1 & 1 \\ 1 & 1
\end{bmatrix}
\end{align*}
\end{problem}

\begin{solution}
The matrix is not invertible, because the determinant is zero.

\begin{align*}
\det \begin{bmatrix}1 & 1 \\ 1 & 1\end{bmatrix} = 1*1 - 1*1 = 0
\end{align*}

\end{solution}

\begin{problem}
\begin{align*}
\begin{bmatrix}
0 & 2 \\ 1 & 1
\end{bmatrix}
\end{align*}
\end{problem}

\begin{solution}

\begin{align*}
\det \begin{bmatrix}0 & 2 \\ 1 & 1\end{bmatrix} = 0*1 - 1*2 = -2
\end{align*}

Thus the matrix is invertible.

\begin{align*}
\begin{bmatrix}0 & 2 \\ 1 & 1\end{bmatrix}^{-1} &= \displaystyle\frac{1}{-2} \begin{bmatrix}1 & -2 \\ -1 & 0\end{bmatrix} \\
&= \begin{bmatrix} -0.5 & 1 \\ 0.5 & 0\end{bmatrix}
\end{align*}


\end{solution}

\end{document}